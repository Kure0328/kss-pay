# バーコードの生成の概要

自分のメモから引っ張り出したので、各要素の名前などが合ってることは保証できません。（by Asa）

## （JAN）バーコードとは
13桁の数字からなる1次元コードのこと。よく商品についてるあれ。

## 構成要素（全113列）
 - 左の余白（11列）
 - 左ガードバー（3列）
 - 左データキャラクタ6桁（42列）
 - センターバー（5列）
 - 右データキャラクタ5桁（35列）
 - チェックディジット1桁（7列）
 - 右ガードバー（3列）
 - 右の余白（7列）

### 左右の余白
すべて白で11列埋める

### 左右ガードバー
どちらも「■□■（黒白黒）」と塗る

### 左右データキャラクタとチェックディジット
後述

### センターバー
「□■□■□（白黒白黒白）」と塗る

## 数の表し方
左側用を基に、
 - 右側用: 左側用を白黒反転
 - 1桁目用: 左側用を白黒反転して、左右反転

### 左側用のデータキャラクタ
白から順に4分割比率で表すと
 - 0: 3211（→□□□■■□■ 白白白黒黒白黒）
 - 1: 2221（→□□■■□□■ 白白黒黒白白黒）
 - 2: 2122
 - 3: 1411
 - 4: 1132
 - 5: 1231
 - 6: 1114
 - 7: 1312
 - 8: 1213
 - 9: 3112

これが 2-7桁目 を表す 「左側用」のデータキャラクタ。<br>
これの白黒を反転させたものが「右側用」で、8-13桁目を表す。

### 1桁目はどこで表す？
左データキャラクタ内で表す。

「左側用」は、奇数パリティ（黒を奇数列含む）だが、「右側用」「1桁目用」は偶数パリティ。<br>
2-7桁目 のどこが偶数パリティで、どこが奇数パリティのままかで判定する。

奇数パリティを0、偶数パリティを1で表すと、「1桁目の数: 2-7桁目の偶奇」として
 - 0: 000000
 - 1: 001011
 - 2: 001101
 - 3: 001110
 - 4: 010011
 - 5: 011001
 - 6: 011100
 - 7: 010101
 - 8: 010110
 - 9: 011010

となる。奇数パリティなら「左側用」をそのまま、偶数パリティなら「1桁目用」を用いる。

## チェックディジットの計算
1. コードの数字に **右から** 順に番号をつける
2. ①でつけた番号が奇数なら *3*、偶数なら *1* を、コードの数字にかける
3. かけた総和を求めて、下1桁を10から引くとチェックディジット。

### 例: 1-12桁目「498279029242」
|     手順     | 4 | 9 | 8 | 2 | 7 | 9 | 0 | 2 | 9 | 2 | 4 | 2 |
|:-----------|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| **①** 番号: |12|11|10|9|8|7|6|5|4|3|2|1|
| **②** かける数: |1|3|1|3|1|3|1|3|1|3|1|3|
| **②** かけた結果: |4|27|8|6|7|27|0|6|9|6|4|6|

**③** 総和: `4 + 27 + 8 + 6 + 7 + 27 + 0 + 6 + 9 + 6 + 4 + 6` = 110<br>
**③** チェックディジット: `10 - 0` = 10（この場合は「0」がチェックディジット）